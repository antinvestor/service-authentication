{{ define "title"}}{{ if .profile_name }}{{ if .t.page_title_verification }}{{ .t.page_title_verification }}{{ else }}Enter Verification Code{{ end }}{{ else }}{{ if .t.page_title_complete_sign_in }}{{ .t.page_title_complete_sign_in }}{{ else }}Complete Your Sign In{{ end }}{{ end }}{{ end }}

{{ define "subtitle" }}
<p id="pageSubtitle">
{{ if .profile_name }}{{ if .t.help_code_sent }}{{ .t.help_code_sent }}{{ else }}Check your email or phone for the code we sent{{ end }}
{{ else }}{{ if .t.help_enter_name_and_code }}{{ .t.help_enter_name_and_code }}{{ else }}Enter your name and the verification code we sent{{ end }}{{ end }}
</p>
{{ end }}

{{define "content"}}
<!-- Full-page overlay shown during verification/redirect -->
<div id="verificationOverlay" class="verification-overlay" style="display: none;" role="dialog" aria-modal="true" aria-label="{{ if .t.overlay_signing_in }}{{ .t.overlay_signing_in }}{{ else }}Signing you in...{{ end }}">
    <div class="overlay-content">
        <div class="overlay-spinner" aria-hidden="true"></div>
        <p class="overlay-message" aria-live="polite">{{ if .t.overlay_signing_in }}{{ .t.overlay_signing_in }}{{ else }}Signing you in...{{ end }}</p>
    </div>
</div>

<div class="verification-container">

    <!-- Progressive enhancement notice -->
    <noscript>
        <div class="noscript-notice" role="alert">
            {{ if .t.noscript_notice }}{{ .t.noscript_notice }}{{ else }}Enable JavaScript for the best experience.{{ end }}
        </div>
    </noscript>

    {{if .error}}
    <div class="alert alert-error" role="alert" aria-live="assertive">
        <svg class="alert-icon" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
        </svg>
        <span>{{ .error }}</span>
    </div>
    {{end}}

    <form method="post" action="/s/verify/contact/{{ .login_event_id }}/post" class="verification-form" id="verificationForm">
        <input type="hidden" name="login_event_id" value="{{ .login_event_id }}">
        <input type="hidden" name="contact_type" value="{{ .contact_type }}">

        {{ if not .profile_name }}
        <!-- Name field shown only for new users without a profile name -->
        <div class="form-group">
            <label for="profile_name_input">
                {{ if .t.label_your_name }}{{ .t.label_your_name }}{{ else }}Your Name{{ end }}
                <span class="required-indicator" aria-hidden="true">*</span>
            </label>
            <input
                type="text"
                id="profile_name_input"
                name="profile_name"
                placeholder="{{ if .t.placeholder_name }}{{ .t.placeholder_name }}{{ else }}John Doe{{ end }}"
                required
                autocomplete="name"
                aria-required="true"
            >
        </div>
        {{ else }}
        <input type="hidden" name="profile_name" value="{{ .profile_name }}">
        {{ end }}

        <div class="form-group">
            <label for="verification_code">
                {{ if .t.label_verification_code }}{{ .t.label_verification_code }}{{ else }}Verification Code{{ end }}
                <span class="required-indicator" aria-hidden="true">*</span>
            </label>
            <input
                type="text"
                inputmode="numeric"
                id="verification_code"
                name="verification_code"
                placeholder="{{ if .t.placeholder_code }}{{ .t.placeholder_code }}{{ else }}123456{{ end }}"
                maxlength="6"
                pattern="[0-9]{6}"
                required
                autocomplete="one-time-code"
                class="verification-input"
                aria-describedby="code-help"
                aria-required="true"
            >
            <small id="code-help" class="form-help">
                {{if eq .contact_type "CONTACT_TYPE_EMAIL"}}{{ if .t.help_check_email }}{{ .t.help_check_email }}{{ else }}Check your email{{ end }}
                {{else if eq .contact_type "CONTACT_TYPE_PHONE"}}{{ if .t.help_check_phone }}{{ .t.help_check_phone }}{{ else }}Check your phone{{ end }}
                {{else if eq .contact_type "EMAIL"}}{{ if .t.help_check_email }}{{ .t.help_check_email }}{{ else }}Check your email{{ end }}
                {{else if eq .contact_type "PHONE"}}{{ if .t.help_check_phone }}{{ .t.help_check_phone }}{{ else }}Check your phone{{ end }}
                {{else}}{{ if .t.help_check_email_or_phone }}{{ .t.help_check_email_or_phone }}{{ else }}Check your email or phone{{ end }}
                {{end}}
            </small>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn-primary" id="verifyBtn">
                <span>{{ if .t.btn_verify }}{{ .t.btn_verify }}{{ else }}Verify{{ end }}</span>
            </button>
        </div>
    </form>

    <div id="verificationHelp" class="verification-help"
         data-initial-cooldown="{{ if .initial_cooldown }}{{ .initial_cooldown }}{{ else }}30{{ end }}"
         data-resends-left="{{ if .resends_left }}{{ .resends_left }}{{ else }}3{{ end }}">
        <span class="help-text" id="resend-help">{{ if .t.help_no_code }}{{ .t.help_no_code }}{{ else }}No code?{{ end }}</span>
        <button
            type="button"
            id="resendBtn"
            class="resend-link"
            aria-describedby="resend-help resend-status"
        >
            {{ if .t.btn_resend }}{{ .t.btn_resend }}{{ else }}Resend{{ end }}
        </button>
        <span id="resendTimer" class="resend-timer" style="display: none;" aria-hidden="true">
            (<strong id="countdown">60</strong>s)
        </span>
        <!-- Screen reader only timer status -->
        <span id="resend-status" class="sr-only" role="status" aria-live="polite"></span>
    </div>

</div>
{{end}}
