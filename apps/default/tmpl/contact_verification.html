{{ define "title"}}{{ if .profile_name }}Enter Verification Code{{ else }}Complete Your Sign In{{ end }}{{ end }}

{{ define "subtitle" }}
<p id="pageSubtitle">
{{ if .profile_name }}Check your email or phone for the code we sent
{{ else }}Enter your name and the verification code we sent{{ end }}
</p>
{{ end }}

{{define "content"}}
<!-- Full-page overlay shown during verification/redirect -->
<div id="verificationOverlay" class="verification-overlay" style="display: none;" role="dialog" aria-modal="true" aria-label="Signing you in">
    <div class="overlay-content">
        <div class="overlay-spinner" aria-hidden="true"></div>
        <p class="overlay-message" aria-live="polite">Signing you in...</p>
    </div>
</div>

<div class="verification-container">

    <!-- Progressive enhancement notice -->
    <noscript>
        <div class="noscript-notice" role="alert">
            Enable JavaScript for the best experience.
        </div>
    </noscript>

    {{if .error}}
    <div class="alert alert-error" role="alert" aria-live="assertive">
        <svg class="alert-icon" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
        </svg>
        <span>{{ .error }}</span>
    </div>
    {{end}}

    <form method="post" action="/s/verify/contact/{{ .login_event_id }}/post" class="verification-form" id="verificationForm">
        <input type="hidden" name="login_event_id" value="{{ .login_event_id }}">
        <input type="hidden" name="contact_type" value="{{ .contact_type }}">

        {{ if not .profile_name }}
        <!-- Name field shown only for new users without a profile name -->
        <div class="form-group">
            <label for="profile_name_input">
                Your Name
                <span class="required-indicator" aria-hidden="true">*</span>
            </label>
            <input
                type="text"
                id="profile_name_input"
                name="profile_name"
                placeholder="John Doe"
                required
                autocomplete="name"
                aria-required="true"
            >
        </div>
        {{ else }}
        <input type="hidden" name="profile_name" value="{{ .profile_name }}">
        {{ end }}

        <div class="form-group">
            <label for="verification_code">
                Verification Code
                <span class="required-indicator" aria-hidden="true">*</span>
            </label>
            <input
                type="text"
                inputmode="numeric"
                id="verification_code"
                name="verification_code"
                placeholder="123456"
                maxlength="6"
                pattern="[0-9]{6}"
                required
                autocomplete="one-time-code"
                class="verification-input"
                aria-describedby="code-help"
                aria-required="true"
            >
            <small id="code-help" class="form-help">
                {{if eq .contact_type "CONTACT_TYPE_EMAIL"}}Check your email
                {{else if eq .contact_type "CONTACT_TYPE_PHONE"}}Check your phone
                {{else if eq .contact_type "EMAIL"}}Check your email
                {{else if eq .contact_type "PHONE"}}Check your phone
                {{else}}Check your email or phone
                {{end}}
            </small>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn-primary" id="verifyBtn">
                <span>Verify</span>
            </button>
        </div>
    </form>

    <div id="verificationHelp" class="verification-help"
         data-initial-cooldown="{{ if .initial_cooldown }}{{ .initial_cooldown }}{{ else }}30{{ end }}"
         data-resends-left="{{ if .resends_left }}{{ .resends_left }}{{ else }}3{{ end }}">
        <span class="help-text" id="resend-help">No code?</span>
        <button
            type="button"
            id="resendBtn"
            class="resend-link"
            aria-describedby="resend-help resend-status"
        >
            Resend
        </button>
        <span id="resendTimer" class="resend-timer" style="display: none;" aria-hidden="true">
            (<strong id="countdown">60</strong>s)
        </span>
        <!-- Screen reader only timer status -->
        <span id="resend-status" class="sr-only" role="status" aria-live="polite"></span>
    </div>

</div>
{{end}}
